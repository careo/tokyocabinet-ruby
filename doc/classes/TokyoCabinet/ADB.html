<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: TokyoCabinet::ADB</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">TokyoCabinet::ADB</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/tokyocabinet-doc_rb.html">
                tokyocabinet-doc.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Abstract database is a set of interfaces to use on-memory hash database,
on-memory tree database, hash database, B+ tree database, fixed-length
database, and table database with the same API. Before operations to store
or retrieve records, it is necessary to connect the abstract database
object to the concrete one. The method `<a
href="ADB.html#M000145">open</a>' is used to <a
href="ADB.html#M000145">open</a> a concrete database and the method `<a
href="ADB.html#M000146">close</a>' is used to <a
href="ADB.html#M000146">close</a> the database. To avoid data missing or
corruption, it is important to <a href="ADB.html#M000146">close</a> every
database instance when it is no longer in use.<br/> Except for the interface
below, methods compatible with the `Hash' class are also provided;
`[]', `[]=', `store', `delete', `fetch',
`has_key?', `has_value?', `key', `clear', `<a
href="ADB.html#M000167">size</a>', `empty?', `each',
`each_key', `each_value', and `keys'.<br/>
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000157">adddouble</a>&nbsp;&nbsp;
      <a href="#M000156">addint</a>&nbsp;&nbsp;
      <a href="#M000146">close</a>&nbsp;&nbsp;
      <a href="#M000161">copy</a>&nbsp;&nbsp;
      <a href="#M000155">fwmkeys</a>&nbsp;&nbsp;
      <a href="#M000151">get</a>&nbsp;&nbsp;
      <a href="#M000153">iterinit</a>&nbsp;&nbsp;
      <a href="#M000154">iternext</a>&nbsp;&nbsp;
      <a href="#M000144">new</a>&nbsp;&nbsp;
      <a href="#M000145">open</a>&nbsp;&nbsp;
      <a href="#M000159">optimize</a>&nbsp;&nbsp;
      <a href="#M000150">out</a>&nbsp;&nbsp;
      <a href="#M000165">path</a>&nbsp;&nbsp;
      <a href="#M000147">put</a>&nbsp;&nbsp;
      <a href="#M000149">putcat</a>&nbsp;&nbsp;
      <a href="#M000148">putkeep</a>&nbsp;&nbsp;
      <a href="#M000166">rnum</a>&nbsp;&nbsp;
      <a href="#M000167">size</a>&nbsp;&nbsp;
      <a href="#M000158">sync</a>&nbsp;&nbsp;
      <a href="#M000164">tranabort</a>&nbsp;&nbsp;
      <a href="#M000162">tranbegin</a>&nbsp;&nbsp;
      <a href="#M000163">trancommit</a>&nbsp;&nbsp;
      <a href="#M000160">vanish</a>&nbsp;&nbsp;
      <a href="#M000152">vsiz</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000144" class="method-detail">
        <a name="M000144"></a>

        <div class="method-heading">
          <a href="ADB.src/M000144.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000144.html');return false;">
          <span class="method-name">new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create an abstract database object.<br/> The return value is the <a
href="ADB.html#M000144">new</a> abstract database object.<br/>
</p>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000157" class="method-detail">
        <a name="M000157"></a>

        <div class="method-heading">
          <a href="ADB.src/M000157.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000157.html');return false;">
          <span class="method-name">adddouble</span><span class="method-args">(key, num)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add a real number to a record.<br/> `<em>key</em>' specifies the key.<br/>
`<em>num</em>' specifies the additional value.<br/> If successful, the
return value is the summation value, else, it is `nil'.<br/> If the
corresponding record exists, the value is treated as a real number and is
added to. If no record corresponds, a <a href="ADB.html#M000144">new</a>
record of the additional value is stored. Because records are stored in
binary format, they should be processed with the `unpack' method with
the `d' operator after retrieval.<br/>
</p>
        </div>
      </div>

      <div id="method-M000156" class="method-detail">
        <a name="M000156"></a>

        <div class="method-heading">
          <a href="ADB.src/M000156.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000156.html');return false;">
          <span class="method-name">addint</span><span class="method-args">(key, num)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add an integer to a record.<br/> `<em>key</em>' specifies the key.<br/>
`<em>num</em>' specifies the additional value.<br/> If successful, the
return value is the summation value, else, it is `nil'.<br/> If the
corresponding record exists, the value is treated as an integer and is
added to. If no record corresponds, a <a href="ADB.html#M000144">new</a>
record of the additional value is stored. Because records are stored in
binary format, they should be processed with the `unpack' method with
the `i' operator after retrieval.<br/>
</p>
        </div>
      </div>

      <div id="method-M000146" class="method-detail">
        <a name="M000146"></a>

        <div class="method-heading">
          <a href="ADB.src/M000146.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000146.html');return false;">
          <span class="method-name">close</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Close the database.<br/> If successful, the return value is true, else, it is
false.<br/> Update of a database is assured to be written when the database is
closed. If a writer opens a database but does not <a
href="ADB.html#M000146">close</a> it appropriately, the database will be
broken.<br/>
</p>
        </div>
      </div>

      <div id="method-M000161" class="method-detail">
        <a name="M000161"></a>

        <div class="method-heading">
          <a href="ADB.src/M000161.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000161.html');return false;">
          <span class="method-name">copy</span><span class="method-args">(path)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Copy the database file.<br/> `<em><a
href="ADB.html#M000165">path</a></em>' specifies the <a
href="ADB.html#M000165">path</a> of the destination file. If it begins with
`@', the trailing substring is executed as a command line.<br/> If
successful, the return value is true, else, it is false. False is returned
if the executed command returns non-zero code.<br/> The database file is
assured to be kept synchronized and not modified while the copying or
executing operation is in progress. So, this method is useful to create a
backup file of the database file.<br/>
</p>
        </div>
      </div>

      <div id="method-M000155" class="method-detail">
        <a name="M000155"></a>

        <div class="method-heading">
          <a href="ADB.src/M000155.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000155.html');return false;">
          <span class="method-name">fwmkeys</span><span class="method-args">(prefix, max)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get forward matching keys.<br/> `<em>prefix</em>' specifies the prefix
of the corresponding keys.<br/> `<em>max</em>' specifies the maximum
number of keys to be fetched. If it is not defined or negative, no limit is
specified.<br/> The return value is a list object of the keys of the
corresponding records. This method does never fail and return an empty list
even if no record corresponds.<br/> Note that this function may be very slow
because every key in the database is scanned.<br/>
</p>
        </div>
      </div>

      <div id="method-M000151" class="method-detail">
        <a name="M000151"></a>

        <div class="method-heading">
          <a href="ADB.src/M000151.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000151.html');return false;">
          <span class="method-name">get</span><span class="method-args">(key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Retrieve a record.<br/> `<em>key</em>' specifies the key.<br/> If
successful, the return value is the value of the corresponding record.
`nil' is returned if no record corresponds.<br/>
</p>
        </div>
      </div>

      <div id="method-M000153" class="method-detail">
        <a name="M000153"></a>

        <div class="method-heading">
          <a href="ADB.src/M000153.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000153.html');return false;">
          <span class="method-name">iterinit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Initialize the iterator.<br/> If successful, the return value is true, else,
it is false.<br/> The iterator is used in order to access the key of every
record stored in a database.<br/>
</p>
        </div>
      </div>

      <div id="method-M000154" class="method-detail">
        <a name="M000154"></a>

        <div class="method-heading">
          <a href="ADB.src/M000154.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000154.html');return false;">
          <span class="method-name">iternext</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the next key of the iterator.<br/> If successful, the return value is the
next key, else, it is `nil'. `nil' is returned when no record
is to be <a href="ADB.html#M000151">get</a> <a
href="ADB.html#M000150">out</a> of the iterator.<br/> It is possible to access
every record by iteration of calling this method. It is allowed to update
or remove records whose keys are fetched while the iteration. However, it
is not assured if updating the database is occurred while the iteration.
Besides, the order of this traversal access method is arbitrary, so it is
not assured that the order of storing matches the one of the traversal
access.<br/>
</p>
        </div>
      </div>

      <div id="method-M000145" class="method-detail">
        <a name="M000145"></a>

        <div class="method-heading">
          <a href="ADB.src/M000145.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000145.html');return false;">
          <span class="method-name">open</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Open a database.<br/> `<em>name</em>' specifies the name of the
database. If it is &quot;*&quot;, the database will be an on-memory hash
database. If it is &quot;+&quot;, the database will be an on-memory tree
database. If its suffix is &quot;.tch&quot;, the database will be a hash
database. If its suffix is &quot;.tcb&quot;, the database will be a B+ tree
database. If its suffix is &quot;.tcf&quot;, the database will be a
fixed-length database. If its suffix is &quot;.tct&quot;, the database will
be a table database. Otherwise, this function fails. Tuning parameters can
trail the name, separated by &quot;#&quot;. Each parameter is composed of
the name and the value, separated by &quot;=&quot;. On-memory hash database
supports &quot;bnum&quot;, &quot;capnum&quot;, and &quot;capsiz&quot;.
On-memory tree database supports &quot;capnum&quot; and &quot;capsiz&quot;.
Hash database supports &quot;mode&quot;, &quot;bnum&quot;,
&quot;apow&quot;, &quot;fpow&quot;, &quot;opts&quot;, &quot;rcnum&quot;,
and &quot;xmsiz&quot;. B+ tree database supports &quot;mode&quot;,
&quot;lmemb&quot;, &quot;nmemb&quot;, &quot;bnum&quot;, &quot;apow&quot;,
&quot;fpow&quot;, &quot;opts&quot;, &quot;lcnum&quot;, &quot;ncnum&quot;,
and &quot;xmsiz&quot;. Fixed-length database supports &quot;mode&quot;,
&quot;width&quot;, and &quot;limsiz&quot;. Table database supports
&quot;mode&quot;, &quot;bnum&quot;, &quot;apow&quot;, &quot;fpow&quot;,
&quot;opts&quot;, &quot;rcnum&quot;, &quot;lcnum&quot;, &quot;ncnum&quot;,
&quot;xmsiz&quot;, and &quot;idx&quot;.<br/> If successful, the return value
is true, else, it is false.<br/> The tuning parameter &quot;capnum&quot;
specifies the capacity number of records. &quot;capsiz&quot; specifies the
capacity <a href="ADB.html#M000167">size</a> of using memory. Records
spilled the capacity are removed by the storing order. &quot;mode&quot; can
contain &quot;w&quot; of writer, &quot;r&quot; of reader, &quot;c&quot; of
creating, &quot;t&quot; of truncating, &quot;e&quot; of no locking, and
&quot;f&quot; of non-blocking lock. The default mode is relevant to
&quot;wc&quot;. &quot;opts&quot; can contains &quot;l&quot; of large
option, &quot;d&quot; of Deflate option, &quot;b&quot; of BZIP2 option, and
&quot;t&quot; of TCBS option. &quot;idx&quot; specifies the column name of
an index and its type separated by &quot;:&quot;. For example,
&quot;casket.tch#bnum=1000000#opts=ld&quot; means that the name of the
database file is &quot;casket.tch&quot;, and the bucket number is 1000000,
and the options are large and Deflate.<br/>
</p>
        </div>
      </div>

      <div id="method-M000159" class="method-detail">
        <a name="M000159"></a>

        <div class="method-heading">
          <a href="ADB.src/M000159.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000159.html');return false;">
          <span class="method-name">optimize</span><span class="method-args">(params)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Optimize the storage.<br/> `<em>params</em>' specifies the string of the
tuning parameters, which works as with the tuning of parameters the
function `tcadbopen'. If it is not defined, it is not used.<br/> If
successful, the return value is true, else, it is false.<br/>
</p>
        </div>
      </div>

      <div id="method-M000150" class="method-detail">
        <a name="M000150"></a>

        <div class="method-heading">
          <a href="ADB.src/M000150.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000150.html');return false;">
          <span class="method-name">out</span><span class="method-args">(key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Remove a record.<br/> `<em>key</em>' specifies the key.<br/> If successful,
the return value is true, else, it is false.<br/>
</p>
        </div>
      </div>

      <div id="method-M000165" class="method-detail">
        <a name="M000165"></a>

        <div class="method-heading">
          <a href="ADB.src/M000165.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000165.html');return false;">
          <span class="method-name">path</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the <a href="ADB.html#M000165">path</a> of the database file.<br/> The
return value is the <a href="ADB.html#M000165">path</a> of the database
file or `nil' if the object does not connect to any database
instance. &quot;*&quot; stands for on-memory hash database. &quot;+&quot;
stands for on-memory tree database.<br/>
</p>
        </div>
      </div>

      <div id="method-M000147" class="method-detail">
        <a name="M000147"></a>

        <div class="method-heading">
          <a href="ADB.src/M000147.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000147.html');return false;">
          <span class="method-name">put</span><span class="method-args">(key, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Store a record.<br/> `<em>key</em>' specifies the key.<br/>
`<em>value</em>' specifies the value.<br/> If successful, the return
value is true, else, it is false.<br/> If a record with the same key exists in
the database, it is overwritten.<br/>
</p>
        </div>
      </div>

      <div id="method-M000149" class="method-detail">
        <a name="M000149"></a>

        <div class="method-heading">
          <a href="ADB.src/M000149.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000149.html');return false;">
          <span class="method-name">putcat</span><span class="method-args">(key, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Concatenate a value at the end of the existing record.<br/>
`<em>key</em>' specifies the key.<br/> `<em>value</em>' specifies
the value.<br/> If successful, the return value is true, else, it is false.<br/>
If there is no corresponding record, a <a href="ADB.html#M000144">new</a>
record is created.<br/>
</p>
        </div>
      </div>

      <div id="method-M000148" class="method-detail">
        <a name="M000148"></a>

        <div class="method-heading">
          <a href="ADB.src/M000148.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000148.html');return false;">
          <span class="method-name">putkeep</span><span class="method-args">(key, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Store a <a href="ADB.html#M000144">new</a> record.<br/> `<em>key</em>'
specifies the key.<br/> `<em>value</em>' specifies the value.<br/> If
successful, the return value is true, else, it is false.<br/> If a record with
the same key exists in the database, this method has no effect.<br/>
</p>
        </div>
      </div>

      <div id="method-M000166" class="method-detail">
        <a name="M000166"></a>

        <div class="method-heading">
          <a href="ADB.src/M000166.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000166.html');return false;">
          <span class="method-name">rnum</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the number of records.<br/> The return value is the number of records or 0
if the object does not connect to any database instance.<br/>
</p>
        </div>
      </div>

      <div id="method-M000167" class="method-detail">
        <a name="M000167"></a>

        <div class="method-heading">
          <a href="ADB.src/M000167.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000167.html');return false;">
          <span class="method-name">size</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the <a href="ADB.html#M000167">size</a> of the database.<br/> The return
value is the <a href="ADB.html#M000167">size</a> of the database or 0 if
the object does not connect to any database instance.<br/>
</p>
        </div>
      </div>

      <div id="method-M000158" class="method-detail">
        <a name="M000158"></a>

        <div class="method-heading">
          <a href="ADB.src/M000158.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000158.html');return false;">
          <span class="method-name">sync</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Synchronize updated contents with the file and the device.<br/> If successful,
the return value is true, else, it is false.<br/> This method is useful when
another process connects the same database file.<br/>
</p>
        </div>
      </div>

      <div id="method-M000164" class="method-detail">
        <a name="M000164"></a>

        <div class="method-heading">
          <a href="ADB.src/M000164.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000164.html');return false;">
          <span class="method-name">tranabort</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Abort the transaction.<br/> If successful, the return value is true, else, it
is false.<br/> Update in the transaction is discarded when it is aborted. The
state of the database is rollbacked to before transaction.<br/>
</p>
        </div>
      </div>

      <div id="method-M000162" class="method-detail">
        <a name="M000162"></a>

        <div class="method-heading">
          <a href="ADB.src/M000162.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000162.html');return false;">
          <span class="method-name">tranbegin</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Begin the transaction.<br/> If successful, the return value is true, else, it
is false.<br/> The database is locked by the thread while the transaction so
that only one transaction can be activated with a database object at the
same time. Thus, the serializable isolation level is assumed if every
database operation is performed in the transaction. All updated regions are
kept track of by write ahead logging while the transaction. If the database
is closed during transaction, the transaction is aborted implicitly.<br/>
</p>
        </div>
      </div>

      <div id="method-M000163" class="method-detail">
        <a name="M000163"></a>

        <div class="method-heading">
          <a href="ADB.src/M000163.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000163.html');return false;">
          <span class="method-name">trancommit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Commit the transaction.<br/> If successful, the return value is true, else, it
is false.<br/> Update in the transaction is fixed when it is committed
successfully.<br/>
</p>
        </div>
      </div>

      <div id="method-M000160" class="method-detail">
        <a name="M000160"></a>

        <div class="method-heading">
          <a href="ADB.src/M000160.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000160.html');return false;">
          <span class="method-name">vanish</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Remove all records.<br/> If successful, the return value is true, else, it is
false.<br/>
</p>
        </div>
      </div>

      <div id="method-M000152" class="method-detail">
        <a name="M000152"></a>

        <div class="method-heading">
          <a href="ADB.src/M000152.html" target="Code" class="method-signature"
            onclick="popupCode('ADB.src/M000152.html');return false;">
          <span class="method-name">vsiz</span><span class="method-args">(key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the <a href="ADB.html#M000167">size</a> of the value of a record.<br/>
`<em>key</em>' specifies the key.<br/> If successful, the return value
is the <a href="ADB.html#M000167">size</a> of the value of the
corresponding record, else, it is -1.<br/>
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
</div>

</body>
</html>
